import{a as x,g as D}from"./main-xonCUAoo.js";const k=c=>c?c<0?"pop":"push":"update",M=({doc:c})=>{const i=c.contentWindow;if(!i)return;const{history:n}=i;let r=[],s=[],o=-1,y=0,a=null;const h=()=>i.location.hash??"",I=t=>{if(!t)return"";try{return new URL(t,i.location.href).hash??""}catch{return""}},g=()=>(y+=1,y),l=()=>{if(r.length===0){r=[g()],s=[h()],o=0;return}s.length===0&&(s=[h()])},p=t=>{var e,u;!r.length||o<0||(u=(e=D()).notifyNavigation)==null||u.call(e,{type:t,canGoBack:o>0,canGoForward:o<r.length-1})},b=(t,e=h())=>{l(),o<r.length-1&&(r=r.slice(0,o+1),s=s.slice(0,o+1)),r=[...r,g()],s=[...s,e],o=r.length-1,a=null,p(t)},m=(t=h())=>{l(),o>=0&&(r[o]=g(),s[o]=t),a=null,p("replace")},f=t=>{if(l(),!r.length)return;const e=typeof t=="number"&&Number.isFinite(t)?Math.trunc(t):0;e!==0&&(o=Math.min(r.length-1,Math.max(0,o+e))),a=null,p(k(e))},S=()=>{f(a??-1)},E=t=>{const e=h();if(a!=null){f(a);return}l();const u=I(t==null?void 0:t.oldURL),d=s.lastIndexOf(e);if(d!==-1&&d!==o){f(d-o);return}if(d===o){p("update");return}if(u&&s[o]===u){m(e);return}b("push",e)},F=n.pushState.bind(n);n.pushState=function(...t){const e=F(...t);return b("push"),e};const H=n.replaceState.bind(n);n.replaceState=function(...t){const e=H(...t);return m(),e};const N=n.back.bind(n);n.back=function(...t){return a=-1,N(...t)};const R=n.forward.bind(n);n.forward=function(...t){return a=1,R(...t)};const w=n.go.bind(n);n.go=function(...t){const[e=0]=t,u=typeof e=="number"&&Number.isFinite(e)?Math.trunc(e):Number.parseInt(String(e),10);return a=Number.isFinite(u)?u:null,w(...t)},n.popToRoot=function(){l();const t=-o;if(t===0){a=null;return}return a=t,w(t)},i.addEventListener("popstate",S),i.addEventListener("hashchange",E),l(),p("replace")},T={go:c=>{var i,n;(n=(i=x())==null?void 0:i.contentWindow)==null||n.history.go(c)},popToRoot:()=>{var c,i,n,r;(r=(n=(i=(c=x())==null?void 0:c.contentWindow)==null?void 0:i.history).popToRoot)==null||r.call(n)}};export{T as navigation,M as useNavigation};
